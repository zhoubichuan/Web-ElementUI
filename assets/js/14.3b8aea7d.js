(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{636:function(e,a,t){"use strict";t.r(a);var r={data:()=>({loading:!1,activeName:["base-info","history-record"],rules:{nameEn:[{required:!0,message:"请输入英文名称",trigger:"change"}],name:[{required:!0,message:"请输入中文名称",trigger:"change"}],descriptEn:[],descript:[{required:!0,message:"请输入中文描述",trigger:"change"}],parentId:[{required:!0,message:"请选择父模型",trigger:"change"}],storeType:[],modelType:[{required:!0,message:"请选择模型类型",trigger:"change"}],inherit:[],tableName:[{required:!0,message:"请输入表名称",trigger:"change"}]},baseInfoForm:{storeType:!1,inherit:!1}}),inject:{rootPage:{type:Object}},created(){this.handleInit()},methods:{handleInit(){this.baseInfoForm=this.$set(this,"baseInfoForm",window._.cloneDeep(this.rootPage.tabsData.data))},async checkValidate(e){this.loading=!0;let{rej:a,err:t}=await this.$awaitWarp(this.$refs.form.validate());if(!1===a||t)return this.loading=!1,!1;e()},async handleAdd(){let e=this.$filterObj(this.baseInfoForm,["nameEn","name","descriptEn","descript","parentId","storeType","modelType","inherit","tableName"]),a=await this.$api.createDataEntity(e);try{a?(this.$message({message:"数据创建成功",type:"success"}),this.$findComponentUpward(this,"DataEntity").$emit("handleSearch")):this.$message.error(a.msg)}catch(e){console.log(e)}finally{this.loading=!1}},handleEdit(){let e=this.$filterObj(this.baseInfoForm,["id","nameEn","name","descriptEn","descript","parentId","storeType","modelType","inherit","tableName"]);this.$api.updateDataEntity(e).then(e=>{if(200===e.statusCode){this.$message({message:e.msg,type:"success"}),this.baseInfoForm=e.result,this.$findComponentUpward(this,"DataEntity").$emit("handleSearch")}else this.$message.error(e.msg);this.loading=!1})}},computed:{pageSate(){return this.rootPage.tabsData.state},disableds(){let e={code:!1,state:!1,nameEn:!1,name:!1,descriptEn:!1,descript:!1,parentId:!1,storeType:!1,modelType:!1,inherit:!1,tableName:!1,version:!1,creater:!1,creatTime:!1,modifier:!1,modifyTime:!1};if("show"!==this.pageSate){"edit"===this.pageSate?(e.code=!0,e.state=!0,e.version=!0,e.creater=!0,e.creatTime=!0,e.modifier=!0,e.modifyTime=!0):e.historyRecord=!1;let a=this.rootPage.tabsData.data,t=this.baseInfoForm;e.saveButton=window._.isEqual(a,t),console.log(e.saveButton)}return e},shows(){let e={saveButton:!1,historyRecord:!0};return"show"!==this.pageSate&&(e.saveButton=!0,e.code=!1,e.state=!1,"edit"===this.pageSate||(e.historyRecord=!1)),e},baseFormData(){this.$createElement;let e={code:{label:"编码",render:this.baseInfoForm.code},state:{label:"状态",render:this.baseInfoForm.state},nameEn:{label:"英文名称",render:this.baseInfoForm.nameEn},name:{label:"中文名称",render:this.baseInfoForm.name},descriptEn:{label:"英文描述",singleFormItem:!0,render:this.baseInfoForm.descriptEn},descript:{label:"中文描述",singleFormItem:!0,render:this.baseInfoForm.descript},parentId:{label:"父模型",placeholder:"请选择父模型",render:this.baseInfoForm.parentId},modelType:{label:"模型类型",render:this.baseInfoForm.modelType},storeType:{label:"存储类型",render:this.baseInfoForm.storeType},inherit:{label:"是否继承",render:this.baseInfoForm.inherit},tableName:{label:"表名称",render:this.baseInfoForm.tableName},space:{}};return["edit","add"].includes(this.pageSate)&&(e={code:{label:"编码",disabled:this.disableds.code,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},state:{label:"状态",disabled:this.disableds.state,render:(e,{data:{attrs:{formItem:a}}})=>(!a.options&&(a.options=[{label:"是",value:!0},{label:"否",value:!1}]),e("el-select",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[a.options.map(a=>e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}},[a.label]))]))},nameEn:{label:"英文名称",disabled:this.disableds.nameEn,placeholder:"请输入英文名称",render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},name:{label:"中文名称",placeholder:"请输入中文名称",render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},descriptEn:{label:"英文描述",disabled:this.disableds.descriptEn,placeholder:"请输入英文描述",singleFormItem:!0,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{type:"textarea",rows:"2",maxlength:"1024",value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},descript:{label:"中文描述",placeholder:"请输入中文描述",singleFormItem:!0,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{type:"textarea",rows:"2",maxlength:"1024",value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},parentId:{label:"父模型",disabled:this.disableds.parentId,placeholder:"请选择父模型",render:(e,{data:{attrs:{formItem:a}}})=>(!a.options&&(a.options=[{label:"是",value:!0},{label:"否",value:!1}]),e("el-select",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[a.options.map(a=>e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}},[a.label]))]))},modelType:{label:"模型类型",disabled:this.disableds.modelType,options:[{label:"XDM",value:"XDM"},{label:"SYS",value:"SYS"},{label:"GENERE",value:"GENERE"}],render:(e,{data:{attrs:{formItem:a}}})=>(!a.options&&(a.options=[{label:"是",value:!0},{label:"否",value:!1}]),e("el-select",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[a.options.map(a=>e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}},[a.label]))]))},storeType:{label:"存储类型",disabled:this.disableds.storeType,render:(e,{data:{attrs:{formItem:a}}})=>(!a.options&&(a.options=[{label:"是",value:!0},{label:"否",value:!1}]),e("el-radio-group",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[a.options.map(a=>e("el-radio",{key:a.value,attrs:{label:a.value,value:a.value}},[a.label]))]))},inherit:{label:"是否继承",disabled:this.disableds.inherit,render:(e,{data:{attrs:{formItem:a}}})=>(!a.options&&(a.options=[{label:"是",value:!0},{label:"否",value:!1}]),e("el-radio-group",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[a.options.map(a=>e("el-radio",{key:a.value,attrs:{label:a.value,value:a.value}},[a.label]))]))},tableName:{label:"表名称",disabled:this.disableds.tableName,placeholder:"请输入表名称",render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[e("span",{slot:"prepend"},["General"])])},space:{}}),Object.keys(this.shows).forEach(a=>{!1===this.shows[a]&&Reflect.deleteProperty(e,a)}),Object.keys(e).forEach(a=>{e[a].formKey="baseInfoForm",e[a].prop=a}),this.$devideArr(Object.values(e),2)},historyFormData(){this.$createElement;let e={version:{label:"版本",render:this.baseInfoForm.version},space:{},creater:{label:"创建者",render:this.baseInfoForm.creater},creatTime:{label:"创建时间",render:this.baseInfoForm.creatTime},modifier:{label:"更新者",render:this.baseInfoForm.modifier},modifyTime:{label:"更新时间",render:this.baseInfoForm.modifyTime}};return["edit","add"].includes(this.pageSate)&&(e={version:{label:"版本",disabled:this.disableds.version,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},space:{},creater:{label:"创建者",disabled:this.disableds.creater,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},creatTime:{label:"创建时间",disabled:this.disableds.creatTime,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},modifier:{label:"更新者",disabled:this.disableds.modifier,render:(e,{data:{attrs:{formItem:a}}})=>e("el-input",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}})},modifyTime:{label:"更新时间",disabled:this.disableds.modifyTime,render:(e,{data:{attrs:{formItem:a}}})=>(!a.options&&(a.options=[{label:"是",value:!0},{label:"否",value:!1}]),e("el-select",{attrs:{value:this[a.formKey][a.prop],disabled:a.disabled,placeholder:a.placeholder},on:{input:e=>{this.$set(this[a.formKey],a.prop,e)}}},[a.options.map(a=>e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}},[a.label]))]))}}),Object.keys(e).forEach(a=>{e[a].formKey="baseInfoForm",e[a].prop=a}),console.log(this.$devideArr(Object.values(e),2)),this.$devideArr(Object.values(e),2)}}},s=t(1),l=Object(s.a)(r,(function(){var e=this,a=e._self._c;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("web-collapse",{model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[a("el-form",{ref:"form",attrs:{model:e.baseInfoForm,"label-width":"80px",rules:e.rules}},[a("web-collapse-item",{attrs:{title:"基本信息",name:"base-info"}},e._l(e.baseFormData,(function(e,t){return a("web-form-item",{key:t,attrs:{formData:e}})})),1),e._v(" "),e.shows.historyRecord?a("web-collapse-item",{attrs:{title:"历史记录",name:"history-record"}},e._l(e.historyFormData,(function(e,t){return a("web-form-item",{key:t,attrs:{formData:e}})})),1):e._e()],1)],1),e._v(" "),e.shows.saveButton?a("web-button-group",[a("web-button",{attrs:{disabled:e.disableds.saveButton,type:"primary"},on:{click:function(a){e.checkValidate(["add"].includes(e.pageSate)?e.handleAdd:e.handleEdit)}}},[e._v("\n      保存\n    ")])],1):e._e()],1)}),[],!1,null,null,null);a.default=l.exports}}]);